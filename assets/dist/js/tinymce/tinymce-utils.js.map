{"version":3,"sources":["../../../build/js/tinymce/tinymce-utils.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","initTinyMCEPlugin","ithoughts","$d","ready","onDocumentReady","$","itg","iThoughtsTooltipGlossary","itge","iThoughtsTooltipGlossaryEditor","stripQuotes","prefix3","prefix4","tipsTypes","htmlAttrs","isNA","initLoggers","verbosity","removeAccents","translateRegex","translate","A","c","C","E","g","G","I","L","N","O","R","S","U","z","Z","replace","doReplace","match","replaceShortcodes","content","repLength","replaceShortcodesEl","restoreShortcodes","resLength","restoreShortcodesEl","replaceShortcodeElGlossary","all","balise","inner","text","attrs","regex","matched","ret","glossary","tooltip","mediatip","Boolean","exec","hasOwnProperty","indexOf","replaceShortcodeElList","type","attrStr","restoreShortcodeElGlossary","b","term","restoreShortcodeElList","editorForms","list","selection","callback","log","mode","node","start","values","alpha","group","loader","trimFilter","attrsStr","split","map","Function","prototype","String","trim","filter","filterNonNullAttr","end","nodeName","extend","getAttribute","cols","parseInt","desc","makeLoader","ajax","method","async","url","admin_ajax","data","action","success","out","remove","newDom","parseHTML","document","body","append","css","opacity","animate","finishListTinymce","domC","handleFormSubmitted","info","animateEnd","shortcode","atoz","tail","optsStrs","addOpt","label","value","specEncode","push","generateAttr","filterNoNA","val","concat","attr","finalContent","join","error","arguments","tip","escapeContent","atts","attsLength","att","takeAttr","positionAt","positionMy","myInverted","tristate","html","attributes","nodeValue","nodata","Math","max","invert","undefined","tooltipContent","link","tooltip_content","glossary_id","term_search","toLowerCase","mediatip_type","mediatip_content","mediatip_link","mediatip_caption","opts","termcontent","qtiprounded","qtipshadow","qtipstyle","qtiptrigger","position","at","my","span","anim","in","time","maxwidth","glossary_disable_auto_translation","_wpnonce","nonce","finishTipTinymce","animateAfter","attributesList","find","domToValue","toArray","types","typesLength","j","prefix","midPart","optsAttrs","reverse","startsWith","encodeURI","disable_auto_translation","generateSelObject","txtarea","get","sel","substring","selectionStart","selectionEnd","DOM","first","last","QTags","addButton","onClickButton","insertContent","iThoughts","v5"],"mappings":"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","file":"tinymce-utils.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/**\n * @file Script loaded as soon a post editor is opened. It contains all basic functions to insert shortcodes\n *\n * @author Gerkin\n * @copyright 2016 GerkinDevelopment\n * @license https://www.gnu.org/licenses/gpl-3.0.html GPLv3\n * @package ithoughts-tooltip-glossary\n *\n * @version 2.7.0\n */\n\n/*global QTags: false, iThoughtsTooltipGlossaryEditor: false */\n\n'use strict';\n\n/**\n * @function initTinyMCEPlugin\n * @description Namespace & register both term & list TinyMCE plugins for iThoughts Tooltip Glossary\n * @param {Object} ithoughts Appropriate version of iThoughts Tooltip Glossary helper\n */\n( function initTinyMCEPlugin( ithoughts ) {\n\tithoughts.$d.ready( function onDocumentReady() {\n\t\tvar $    \t\t\t= ithoughts.$,\n\t\t\titg\t\t\t\t= iThoughtsTooltipGlossary,\n\t\t\titge\t\t\t= iThoughtsTooltipGlossaryEditor,\n\t\t\tstripQuotes\t\t= itg.stripQuotes,\n\t\t\tprefix3\t\t\t= 'ithoughts-tooltip-glossary',\n\t\t\tprefix4\t\t\t= 'itg',\n\t\t\ttipsTypes\t\t= [ 'ithoughts-tooltip-glossary-term', 'ithoughts-tooltip-glossary-tooltip', 'ithoughts-tooltip-glossary-mediatip' ],\n\t\t\thtmlAttrs\t\t= [ 'href' ],\n\t\t\tisNA\t\t\t= ithoughts.isNA;\n\n\t\tithoughts.initLoggers( itge, 'iThoughts Tooltip Glossary', itge.verbosity );\n\t\titge.removeAccents = function removeAccents( s ) {\n\t\t\tvar translateRegex\t= /[¹²³áàâãäåaaaÀÁÂÃÄÅAAAÆccç©CCÇÐÐèéê?ëeeeeeÈÊË?EEEEE€gGiìíîïìiiiÌÍÎÏ?ÌIIIlLnnñNNÑòóôõöoooøÒÓÔÕÖOOOØŒr®Ršs?ßŠS?ùúûüuuuuÙÚÛÜUUUUýÿÝŸžzzŽZZ]/g,\n\t\t\t\ttranslate\t\t= {\n\t\t\t\t\t'¹': '1',\n\t\t\t\t\t'²': '2',\n\t\t\t\t\t'³': '3',\n\t\t\t\t\t'á': 'a',\n\t\t\t\t\t'à': 'a',\n\t\t\t\t\t'â': 'a',\n\t\t\t\t\t'ã': 'a',\n\t\t\t\t\t'ä': 'a',\n\t\t\t\t\t'å': 'a',\n\t\t\t\t\ta:   'a',\n\t\t\t\t\t'À': 'a',\n\t\t\t\t\t'Á': 'a',\n\t\t\t\t\t'Â': 'a',\n\t\t\t\t\t'Ã': 'a',\n\t\t\t\t\t'Ä': 'a',\n\t\t\t\t\t'Å': 'a',\n\t\t\t\t\tA:   'a',\n\t\t\t\t\t'Æ': 'a',\n\t\t\t\t\tc:   'c',\n\t\t\t\t\t'ç': 'c',\n\t\t\t\t\t'©': 'c',\n\t\t\t\t\tC:   'c',\n\t\t\t\t\t'Ç': 'c',\n\t\t\t\t\t'Ð': 'd',\n\t\t\t\t\t'è': 'e',\n\t\t\t\t\t'é': 'e',\n\t\t\t\t\t'ê': 'e',\n\t\t\t\t\t'?': 's',\n\t\t\t\t\t'ë': 'e',\n\t\t\t\t\te:   'e',\n\t\t\t\t\t'È': 'e',\n\t\t\t\t\t'Ê': 'e',\n\t\t\t\t\t'Ë': 'e',\n\t\t\t\t\tE:   'e',\n\t\t\t\t\t'€': 'e',\n\t\t\t\t\tg:   'g',\n\t\t\t\t\tG:   'g',\n\t\t\t\t\ti:   'i',\n\t\t\t\t\t'ì': 'i',\n\t\t\t\t\t'í': 'i',\n\t\t\t\t\t'î': 'i',\n\t\t\t\t\t'ï': 'i',\n\t\t\t\t\t'Ì': 'i',\n\t\t\t\t\t'Í': 'i',\n\t\t\t\t\t'Î': 'i',\n\t\t\t\t\t'Ï': 'i',\n\t\t\t\t\tI:   'i',\n\t\t\t\t\tl:   'l',\n\t\t\t\t\tL:   'l',\n\t\t\t\t\tn:   'n',\n\t\t\t\t\t'ñ': 'n',\n\t\t\t\t\tN:   'n',\n\t\t\t\t\t'Ñ': 'n',\n\t\t\t\t\t'ò': 'o',\n\t\t\t\t\t'ó': 'o',\n\t\t\t\t\t'ô': 'o',\n\t\t\t\t\t'õ': 'o',\n\t\t\t\t\t'ö': 'o',\n\t\t\t\t\to:   'o',\n\t\t\t\t\t'ø': 'o',\n\t\t\t\t\t'Ò': 'o',\n\t\t\t\t\t'Ó': 'o',\n\t\t\t\t\t'Ô': 'o',\n\t\t\t\t\t'Õ': 'o',\n\t\t\t\t\t'Ö': 'o',\n\t\t\t\t\tO:   'o',\n\t\t\t\t\t'Ø': 'o',\n\t\t\t\t\t'Œ': 'o',\n\t\t\t\t\tr:   'r',\n\t\t\t\t\t'®': 'r',\n\t\t\t\t\tR:   'r',\n\t\t\t\t\t'š': 's',\n\t\t\t\t\ts:   's',\n\t\t\t\t\t'ß': 's',\n\t\t\t\t\t'Š': 's',\n\t\t\t\t\tS:   's',\n\t\t\t\t\t'ù': 'u',\n\t\t\t\t\t'ú': 'u',\n\t\t\t\t\t'û': 'u',\n\t\t\t\t\t'ü': 'u',\n\t\t\t\t\tu:   'u',\n\t\t\t\t\t'Ù': 'u',\n\t\t\t\t\t'Ú': 'u',\n\t\t\t\t\t'Û': 'u',\n\t\t\t\t\t'Ü': 'u',\n\t\t\t\t\tU:   'u',\n\t\t\t\t\t'ý': 'y',\n\t\t\t\t\t'ÿ': 'y',\n\t\t\t\t\t'Ý': 'y',\n\t\t\t\t\t'Ÿ': 'y',\n\t\t\t\t\t'ž': 'z',\n\t\t\t\t\tz:   'z',\n\t\t\t\t\t'Ž': 'z',\n\t\t\t\t\tZ:   'z',\n\t\t\t\t};\n\t\t\treturn s.replace( translateRegex, function doReplace( match ) {\n\t\t\t\treturn translate[match];\n\t\t\t});\n\t\t};\n\n\t\titge.replaceShortcodes = function replaceShortcodes( content ) {\n\t\t\tvar repLength = itge.replaceShortcodesEl.length,\n\t\t\t\ti = -1;\n\t\t\twhile (( i += 1 ) < repLength ) {\n\t\t\t\tcontent = itge.replaceShortcodesEl[i]( content );\n\t\t\t}\n\t\t\treturn content;\n\t\t};\n\t\titge.restoreShortcodes = function restoreShortcodes( content ) {\n\t\t\tvar resLength = itge.restoreShortcodesEl.length,\n\t\t\t\ti = -1;\n\t\t\twhile (( i += 1 ) < resLength ) {\n\t\t\t\tcontent = itge.restoreShortcodesEl[i]( content );\n\t\t\t}\n\t\t\treturn content;\n\t\t};\n\t\titge.replaceShortcodesEl = [\n\t\t\tfunction replaceShortcodeElGlossary( content ) { // For [glossary]\n\t\t\t\treturn content.replace( /\\[(?:itg-)?(glossary|tooltip|mediatip)(?!_)(.*?)\\](.*?)\\[\\/(?:itg-)?(glossary|tooltip|mediatip)\\]/g, function doReplace( all, balise, inner, text ) {\n\t\t\t\t\tvar attrs\t= {},\n\t\t\t\t\t\tregex\t= /([\\w\\d\\-]+?)=\"(.+?)\"/g,\n\t\t\t\t\t\tmatched\t= null,\n\t\t\t\t\t\tret\t\t= `<a data-type=\"${  prefix3  }-${  {\n\t\t\t\t\t\t\tglossary: 'term',\n\t\t\t\t\t\t\ttooltip:  'tooltip',\n\t\t\t\t\t\t\tmediatip: 'mediatip',\n\t\t\t\t\t\t}[balise]  }\"`,\n\t\t\t\t\t\ti;\n\t\t\t\t\twhile ( true === Boolean( matched = regex.exec( inner ))) {\n\t\t\t\t\t\tattrs[matched[1]] = matched[2];\n\t\t\t\t\t}\n\t\t\t\t\tfor ( i in attrs ) {\n\t\t\t\t\t\tif ( attrs.hasOwnProperty( i )) {\n\t\t\t\t\t\t\tif ( htmlAttrs.indexOf( i ) > -1 || 0 === i.indexOf( 'data-' )) {\n\t\t\t\t\t\t\t\tret += ` ${  i  }=\"${  attrs[i]  }\"`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tret += ` data-${  i  }=\"${  attrs[i]  }\"`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn `${ ret  }>${  text  }</a>`;\n\t\t\t\t});\n\t\t\t},\n\t\t\tfunction replaceShortcodeElList( content ) { // For [glossary_(term_list|atoz)]\n\t\t\t\treturn content.replace( /\\[glossary_(term_list|atoz)(.*?)\\/\\]/g, function doReplace( all, type, attrStr ) {\n\t\t\t\t\tvar attrs\t= {},\n\t\t\t\t\t\tregex\t= /([\\w\\d\\-]+?)=\"(.+?)\"/g,\n\t\t\t\t\t\tmatched\t= null,\n\t\t\t\t\t\tret\t\t= `<span data-type=\"${  prefix3  }-${  type  }\"`,\n\t\t\t\t\t\ti;\n\t\t\t\t\twhile ( true === Boolean( matched = regex.exec( attrStr ))) {\n\t\t\t\t\t\tattrs[matched[1]] = matched[2];\n\t\t\t\t\t}\n\t\t\t\t\tfor ( i in attrs ) {\n\t\t\t\t\t\tif ( attrs.hasOwnProperty( i )) {\n\t\t\t\t\t\t\tif ( htmlAttrs.indexOf( i ) > -1 || 0 === i.indexOf( 'data-' )) {\n\t\t\t\t\t\t\t\tret += ` ${  i  }=\"${  attrs[i]  }\"`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tret += ` data-${  i  }=\"${  attrs[i]  }\"`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn `${ ret  }>Glossary ${  ( 'term_list' === type ) ? 'List' : 'A-to-Z'  }</span>`;\n\t\t\t\t});\n\t\t\t},\n\t\t];\n\t\titge.restoreShortcodesEl = [\n\t\t\tfunction restoreShortcodeElGlossary( content ) { // For [glossary]\n\t\t\t\treturn content.replace( /<a\\s+(?=[^>]*data-type=\"ithoughts-tooltip-glossary-(term|tooltip|mediatip)\")(.*?)>(.*?)<\\/a>/g, function doReplace( all, type, inner, text ) {\n\t\t\t\t\tvar attrs\t= {},\n\t\t\t\t\t\tregex\t= /(data-)?([\\w\\d\\-]+?)=\"(.+?)\"/g,\n\t\t\t\t\t\tmatched\t= null,\n\t\t\t\t\t\tb\t\t= {\n\t\t\t\t\t\t\tterm:     'glossary',\n\t\t\t\t\t\t\ttooltip:  'tooltip',\n\t\t\t\t\t\t\tmediatip: 'mediatip',\n\t\t\t\t\t\t}[type],\n\t\t\t\t\t\tret\t\t= `[${  prefix4  }-${  b }`,\n\t\t\t\t\t\ti;\n\t\t\t\t\twhile ( true === Boolean( matched = regex.exec( inner ))) {\n\t\t\t\t\t\tif ( matched[1] !== 'data-' || matched[2] !== 'type' ) {\n\t\t\t\t\t\t\tif ( htmlAttrs.indexOf( matched[2]) > -1 && typeof matched[1] !== 'undefined' ) {\n\t\t\t\t\t\t\t\tattrs[matched[1] + matched[2]] = matched[3];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tattrs[matched[2]] = matched[3];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor ( i in attrs ) {\n\t\t\t\t\t\tif ( attrs.hasOwnProperty( i )) {\n\t\t\t\t\t\t\tret += ` ${  i  }=\"${  attrs[i]  }\"`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn `${ ret  }]${  text  }[/${  prefix4  }-${  b  }]`;\n\t\t\t\t});\n\t\t\t},\n\t\t\tfunction restoreShortcodeElList( content ) { // For [glossary_(term_list|atoz)]\n\t\t\t\treturn content.replace( /<span\\s+(?=[^>]*data-type=\"ithoughts-tooltip-glossary-(term_list|atoz)\")(.*?)>.*?<\\/span>/g, function doReplace( all, type, attrStr ) {\n\t\t\t\t\tvar attrs\t= {},\n\t\t\t\t\t\tregex\t= /(data-)?([\\w\\d\\-]+?)=\"(.+?)\"/g,\n\t\t\t\t\t\tmatched\t= null,\n\t\t\t\t\t\tret\t\t= `[glossary_${  type }`,\n\t\t\t\t\t\ti;\n\t\t\t\t\twhile ( true === Boolean( matched = regex.exec( attrStr ))) {\n\t\t\t\t\t\tif ( matched[1] !== 'data-' || matched[2] !== 'type' ) {\n\t\t\t\t\t\t\tif ( htmlAttrs.indexOf( i ) > -1 && typeof matched[1] !== 'undefined' ) {\n\t\t\t\t\t\t\t\tattrs[matched[1] + matched[2]] = matched[3];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tattrs[matched[2]] = matched[3];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor ( i in attrs ) {\n\t\t\t\t\t\tif ( attrs.hasOwnProperty( i )) {\n\t\t\t\t\t\t\tret += ` ${  i  }=\"${  attrs[i]  }\"`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn `${ ret  }/]`;\n\t\t\t\t});\n\t\t\t},\n\t\t];\n\n\t\titge.editorForms = {\n\t\t\tlist: function list( selection, callback ) {\n\t\t\t\titge.log( 'Selection infos to load TIP: ', selection );\n\t\t\t\tvar mode = 'insert_content',\n\t\t\t\t\tnode\t= selection.start,\n\t\t\t\t\tvalues = {\n\t\t\t\t\t\ttype:  'atoz',\n\t\t\t\t\t\talpha: [],\n\t\t\t\t\t\tgroup: [],\n\t\t\t\t\t},\n\t\t\t\t\tloader;\n\t\t\t\tfunction trimFilter( attrsStr ) {\n\t\t\t\t\treturn ( attrsStr||'' ).split( ',' ).map( Function.prototype.call, String.prototype.trim ).filter( function filterNonNullAttr( e ) {\n\t\t\t\t\t\treturn e;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif ( !isNA( selection.start ) && selection.start === selection.end ) {\n\t\t\t\t\titge.log( `Start & End node are the same, operating on a node of type ${  node.nodeName }` );\n\t\t\t\t\tif ( node && node.nodeName !== '#text' ) {\n\t\t\t\t\t\t$.extend( values, {\n\t\t\t\t\t\t\talpha: trimFilter( node.getAttribute( 'data-alpha' )),\n\t\t\t\t\t\t\tgroup: trimFilter( node.getAttribute( 'data-group' )),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif ( 'ithoughts-tooltip-glossary-atoz' === node.getAttribute( 'data-type' )) { // Is atoz\n\t\t\t\t\t\t\tmode = 'load';\n\t\t\t\t\t\t\tvalues.type = 'atoz';\n\t\t\t\t\t\t} else if ( 'ithoughts-tooltip-glossary-term_list' === node.getAttribute( 'data-type' )) { // Is term_list\n\t\t\t\t\t\t\tmode = 'load';\n\t\t\t\t\t\t\tvalues.type = 'list';\n\t\t\t\t\t\t\t$.extend( values, {\n\t\t\t\t\t\t\t\tcols: parseInt( node.getAttribute( 'data-cols' )),\n\t\t\t\t\t\t\t\tdesc: node.getAttribute( 'data-desc' ),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Then generate form through Ajax\n\t\t\t\tloader = ithoughts.makeLoader();\n\t\t\t\t$.ajax({\n\t\t\t\t\tmethod:\t'POST',\n\t\t\t\t\tasync:  true,\n\t\t\t\t\turl:    itge.admin_ajax,\n\t\t\t\t\tdata:   {\n\t\t\t\t\t\taction: 'ithoughts_tt_gl_get_tinymce_list_form',\n\t\t\t\t\t\tdata:   values,\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function success( out ) {\n\t\t\t\t\t\tloader.remove();\n\t\t\t\t\t\tvar newDom = $( $.parseHTML( out, true ));\n\n\t\t\t\t\t\t$( document.body ).append( newDom.css({\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t}).animate({\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t}, 500 ));\n\n\n\t\t\t\t\t\titge.finishListTinymce = ( function finishListTinymce() {\n\t\t\t\t\t\t\tvar domC = newDom;\n\t\t\t\t\t\t\treturn function handleFormSubmitted( data ) {\n\t\t\t\t\t\t\t\titge.info( 'New list data:', data );\n\t\t\t\t\t\t\t\tdomC.animate({\n\t\t\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\t\t}, 500, function animateEnd() {\n\t\t\t\t\t\t\t\t\tdomC.remove();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif ( 'undefined' === typeof data ) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvar shortcode = `glossary_${  ({\n\t\t\t\t\t\t\t\t\t\tatoz: 'atoz',\n\t\t\t\t\t\t\t\t\t\tlist: 'term_list',\n\t\t\t\t\t\t\t\t\t})[data.type] }`,\n\t\t\t\t\t\t\t\t\ttail = ( mode !== 'load' ) ? ' ' : '',\n\t\t\t\t\t\t\t\t\toptsStrs\t\t= [],\n\t\t\t\t\t\t\t\t\taddOpt\t\t\t= function addOpt( label, value, specEncode ) {\n\t\t\t\t\t\t\t\t\t\toptsStrs.push( generateAttr( label, value, specEncode ));\n\t\t\t\t\t\t\t\t\t\toptsStrs = optsStrs.filter( function filterNoNA( val ) {\n\t\t\t\t\t\t\t\t\t\t\treturn !isNA( val );\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t};\n\n\n\t\t\t\t\t\t\t\tvar attrs = [ 'alpha', 'group' ];\n\t\t\t\t\t\t\t\tswitch ( data.type ) {\n\t\t\t\t\t\t\t\t\tcase 'list': {\n\t\t\t\t\t\t\t\t\t\tattrs = attrs.concat([ 'cols', 'desc' ]);\n\t\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t\t\t\t\t\t   }\n\n\t\t\t\t\t\t\t\tfor ( var i = 0, I = attrs.length; i < I; i++ ) {\n\t\t\t\t\t\t\t\t\tvar attr = attrs[i];\n\t\t\t\t\t\t\t\t\tif ( data.hasOwnProperty( attr )) {\n\t\t\t\t\t\t\t\t\t\taddOpt( attr, data[attr]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvar finalContent = `[${  shortcode  } ${  optsStrs.join( ' ' )  }/]${  tail }`;\n\t\t\t\t\t\t\t\titge.log( 'Final content:', finalContent );\n\t\t\t\t\t\t\t\treturn callback( finalContent, mode );\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}());\n\t\t\t\t\t},\n\t\t\t\t\terror: function error() {\n\t\t\t\t\t\tloader.remove();\n\t\t\t\t\t\titge.error( 'Error while getting TinyMCE form for Tip: ', arguments );\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\ttip: function tip( selection, callback, escapeContent ) {\n\t\t\t\titge.info( 'Selection infos to load TIP: ', selection );\n\t\t\t\tvar values\t= {},\n\t\t\t\t\tnode\t= selection.start,\n\t\t\t\t\tmode\t= '',\n\t\t\t\t\ti\t\t= -1,\n\t\t\t\t\tcontent,\n\t\t\t\t\tatts,\n\t\t\t\t\tattsLength,\n\t\t\t\t\tattrs,\n\t\t\t\t\tatt,\n\t\t\t\t\ttakeAttr,\n\t\t\t\t\tpositionAt,\n\t\t\t\t\tpositionMy,\n\t\t\t\t\tmyInverted,\n\t\t\t\t\ttristate,\n\t\t\t\t\tloader;\n\t\t\t\tif ( !isNA( selection.start ) && selection.start === selection.end ) {\n\t\t\t\t\titge.log( `Start & End node are the same, operating on a node of type ${  node.nodeName }` );\n\t\t\t\t\tcontent = ( node && node.text ) || selection.html; // Get node text if any or get selection\n\t\t\t\t\titge.log( 'Loading content: ', content );\n\t\t\t\t\tif ( node && node.nodeName !== '#text' && tipsTypes.indexOf( node.getAttribute( 'data-type' )) > -1 ) { // On Glossary Term or Tooltip or Mediatip, load data\n\t\t\t\t\t\tmode = 'load';\n\t\t\t\t\t\tattrs = {};\n\t\t\t\t\t\tatts = node.attributes;\n\t\t\t\t\t\tattsLength = atts.length;\n\t\t\t\t\t\twhile (( i += 1 ) < attsLength ) {\n\t\t\t\t\t\t\tatt = atts[i];\n\t\t\t\t\t\t\tattrs[att.nodeName] = att.nodeValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttakeAttr = function takeAttr( label, nodata ) {\n\t\t\t\t\t\t\tif ( isNA( nodata ) || !nodata ) {\n\t\t\t\t\t\t\t\tlabel = `data-${  label }`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar val = attrs[label];\n\t\t\t\t\t\t\tdelete attrs[label];\n\t\t\t\t\t\t\treturn val;\n\t\t\t\t\t\t};\n\n\n\t\t\t\t\t\tpositionAt = ( takeAttr( 'position-at' ) || ' ' ).split( ' ' );\n\t\t\t\t\t\tpositionMy = ( takeAttr( 'position-my' ) || ' ' ).split( ' ' );\n\t\t\t\t\t\tmyInverted = ( 1 === Math.max( positionMy.indexOf( 'top' ), positionMy.indexOf( 'bottom' ))) || ( 0 === Math.max( positionMy.indexOf( 'right' ), positionMy.indexOf( 'left' )));\n\t\t\t\t\t\tpositionAt = {\n\t\t\t\t\t\t\t1: positionAt[0],\n\t\t\t\t\t\t\t2: positionAt[1],\n\t\t\t\t\t\t};\n\t\t\t\t\t\tpositionMy = {\n\t\t\t\t\t\t\t1:      positionMy[myInverted ? 1 : 0],\n\t\t\t\t\t\t\t2:      positionMy[myInverted ? 0 : 1],\n\t\t\t\t\t\t\tinvert: myInverted ? 'enabled' : undefined,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\ttristate = function tristate( val ) {\n\t\t\t\t\t\t\tif ( 'true' === val ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( 'false' === val ) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar tooltipContent = takeAttr( 'tooltip-content' );\n\t\t\t\t\t\tif ( escapeContent && tooltipContent ) {\n\t\t\t\t\t\t\ttooltipContent = tooltipContent.replace( /&lt;/g, '<' ).replace( /&gt;/g, '>' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvalues = {\n\t\t\t\t\t\t\ttext:             content,\n\t\t\t\t\t\t\tlink:             takeAttr( 'href', true ),\n\t\t\t\t\t\t\ttooltip_content:  stripQuotes( tooltipContent || content, false ),\n\t\t\t\t\t\t\tglossary_id:      takeAttr( 'glossary-id' ),\n\t\t\t\t\t\t\tterm_search:      itge.removeAccents( content.toLowerCase()),\n\t\t\t\t\t\t\tmediatip_type:    takeAttr( 'mediatip-type' ),\n\t\t\t\t\t\t\tmediatip_content: stripQuotes( takeAttr( 'mediatip-content' ), false ),\n\t\t\t\t\t\t\tmediatip_link:    takeAttr( 'mediatip-link' ),\n\t\t\t\t\t\t\tmediatip_caption: takeAttr( 'mediatip-caption' ),\n\t\t\t\t\t\t\ttype:             [ 'glossary', 'tooltip', 'mediatip' ][tipsTypes.indexOf( takeAttr( 'type' ))],\n\t\t\t\t\t\t\topts:             {\n\t\t\t\t\t\t\t\ttermcontent:      takeAttr( 'termcontent' ),\n\t\t\t\t\t\t\t\t'qtip-keep-open': 'true' === takeAttr( 'qtip-keep-open' ),\n\t\t\t\t\t\t\t\tqtiprounded:      tristate( takeAttr( 'qtiprounded' )),\n\t\t\t\t\t\t\t\tqtipshadow:       tristate( takeAttr( 'qtipshadow' )),\n\t\t\t\t\t\t\t\tqtipstyle:        takeAttr( 'qtipstyle' ),\n\t\t\t\t\t\t\t\tqtiptrigger:      takeAttr( 'qtiptrigger' ),\n\t\t\t\t\t\t\t\tposition:         {\n\t\t\t\t\t\t\t\t\tat:\tpositionAt,\n\t\t\t\t\t\t\t\t\tmy:\tpositionMy,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tattributes:\t{\n\t\t\t\t\t\t\t\t\tspan: {},\n\t\t\t\t\t\t\t\t\tlink:\t{},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tanim: {\n\t\t\t\t\t\t\t\t\tin:   takeAttr( 'animation_in' ),\n\t\t\t\t\t\t\t\t\tout:  takeAttr( 'animation_out' ),\n\t\t\t\t\t\t\t\t\ttime: takeAttr( 'animation_time' ),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmaxwidth: takeAttr( 'tooltip-maxwidth' ),\n\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\tglossary_disable_auto_translation: 'true' === ( takeAttr( 'disable_auto_translation' ) || false ),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfor ( i in attrs ) {\n\t\t\t\t\t\t\tif ( attrs.hasOwnProperty( i )) {\n\t\t\t\t\t\t\t\tif ( i.match( /^data-link-/ )) {\n\t\t\t\t\t\t\t\t\tvalues.opts.attributes.link[i.replace( /^data-link-(data-)?/, '' )] = attrs[i];\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvalues.opts.attributes.span[i.replace( /^data-/, '' )] = attrs[i];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Create new glossary term\n\t\t\t\t\t\tvalues\t= {\n\t\t\t\t\t\t\ttext:             '',\n\t\t\t\t\t\t\tlink:             '',\n\t\t\t\t\t\t\ttooltip_content:  '',\n\t\t\t\t\t\t\tglossary_id:      null,\n\t\t\t\t\t\t\tterm_search:      '',\n\t\t\t\t\t\t\tmediatip_type:    '',\n\t\t\t\t\t\t\tmediatip_content: '',\n\t\t\t\t\t\t\tmediatip_caption: '',\n\t\t\t\t\t\t\ttype:             'tooltip',\n\n\t\t\t\t\t\t\tglossary_disable_auto_translation:\tfalse,\n\t\t\t\t\t\t};\n\t\t\t\t\t\t// If something is selected, load the content as text, content for tooltip & search\n\t\t\t\t\t\tif ( content && content.length > 0 ) {\n\t\t\t\t\t\t\tmode\t= 'replace_content';\n\t\t\t\t\t\t\tvalues\t= $.extend( values, {\n\t\t\t\t\t\t\t\ttext:            content,\n\t\t\t\t\t\t\t\ttooltip_content: content,\n\t\t\t\t\t\t\t\tterm_search:     itge.removeAccents( content.toLowerCase()),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmode\t= 'add_content';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Then generate form through Ajax\n\t\t\t\tloader = ithoughts.makeLoader();\n\t\t\t\t$.ajax({\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tasync:  true,\n\t\t\t\t\turl:    itge.admin_ajax,\n\t\t\t\t\tdata:   {\n\t\t\t\t\t\taction:\t  'ithoughts_tt_gl_get_tinymce_tooltip_form',\n\t\t\t\t\t\tdata:     values,\n\t\t\t\t\t\t_wpnonce: itge.nonce,\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function success( out ) {\n\t\t\t\t\t\tloader.remove();\n\t\t\t\t\t\tvar newDom = $( $.parseHTML( out, true ));\n\t\t\t\t\t\t$( document.body ).append( newDom.css({\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t}).animate({\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t}, 500 ));\n\n\n\t\t\t\t\t\titge.finishTipTinymce = ( function finishTipTinymce() {\n\t\t\t\t\t\t\tvar domC = newDom;\n\t\t\t\t\t\t\treturn function handleFormSubmitted( data ) {\n\t\t\t\t\t\t\t\titge.info( 'New tooltip data:', data );\n\t\t\t\t\t\t\t\tdomC.animate({\n\t\t\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\t\t}, 500, function animateAfter() {\n\t\t\t\t\t\t\t\t\tdomC.remove();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif ( 'undefined' === typeof data || null === data ) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar optsStrs\t\t= [],\n\t\t\t\t\t\t\t\t\tattributesList\t= domC.find( '#attributes-list option' ).map( function domToValue() {\n\t\t\t\t\t\t\t\t\t\treturn this.value;\n\t\t\t\t\t\t\t\t\t}).toArray(),\n\t\t\t\t\t\t\t\t\topts\t\t\t= data.opts || values.opts,\n\t\t\t\t\t\t\t\t\taddOpt\t\t\t= ( label, value, specEncode ) => {\n\t\t\t\t\t\t\t\t\t\toptsStrs.push( generateAttr( label, value, specEncode ));\n\t\t\t\t\t\t\t\t\t\toptsStrs = optsStrs.filter( function filterNoNA( val ) {\n\t\t\t\t\t\t\t\t\t\t\treturn !isNA( val );\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tmy,\n\t\t\t\t\t\t\t\t\ttypes\t\t\t= [ 'span', 'link' ],\n\t\t\t\t\t\t\t\t\ttypesLength\t\t= types.length,\n\t\t\t\t\t\t\t\t\ti\t\t\t\t= -1,\n\t\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\t\tprefix,\n\t\t\t\t\t\t\t\t\tmidPart,\n\t\t\t\t\t\t\t\t\toptsAttrs\t\t= ( opts && opts.attributes ) || {},\n\t\t\t\t\t\t\t\t\tshortcode\t\t= `${ prefix4  }-${  data.type }`,\n\t\t\t\t\t\t\t\t\ttail\t\t\t= ( mode !== 'load' && 0 === content.length ) ? ' ' : '';\n\n\t\t\t\t\t\t\t\tif ( !isNA( opts )) {\n\t\t\t\t\t\t\t\t\tif ( opts['qtip-content']) {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'data-termcontent', opts['qtip-content']);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( opts['qtip-keep-open']) {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'data-qtip-keep-open', 'true' );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( !isNA( opts.qtiprounded )) {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'data-qtiprounded', String( opts.qtiprounded ));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( !isNA( opts.qtipshadow )) {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'data-qtipshadow', String( opts.qtipshadow ));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( opts.qtipstyle ) {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'data-qtipstyle', opts.qtipstyle );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( opts.qtiptrigger ) {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'data-qtiptrigger', opts.qtiptrigger );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( opts.position ) {\n\t\t\t\t\t\t\t\t\t\tif ( opts.position.at && opts.position.at[1] && opts.position.at[2]) {\n\t\t\t\t\t\t\t\t\t\t\taddOpt( 'data-position-at', `${ opts.position.at[1]  } ${  opts.position.at[2] }` );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ( opts.position.my && opts.position.my[1] && opts.position.my[2]) {\n\t\t\t\t\t\t\t\t\t\t\tmy = [ opts.position.my[1], opts.position.my[2] ];\n\t\t\t\t\t\t\t\t\t\t\tif ( opts.position.my.invert ) {\n\t\t\t\t\t\t\t\t\t\t\t\tmy.reverse();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\taddOpt( 'data-position-my', my.join( ' ' ));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( opts.anim ) {\n\t\t\t\t\t\t\t\t\t\tif ( opts.anim['in']) {\n\t\t\t\t\t\t\t\t\t\t\taddOpt( 'data-animation_in', opts.anim['in']);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ( opts.anim.out ) {\n\t\t\t\t\t\t\t\t\t\t\taddOpt( 'data-animation_out', opts.anim.out );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ( opts.anim.time ) {\n\t\t\t\t\t\t\t\t\t\t\taddOpt( 'data-animation_time', opts.anim.time );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ( opts.maxwidth ) {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'data-tooltip-maxwidth', opts.maxwidth );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\twhile ( i++ < typesLength ) {\n\t\t\t\t\t\t\t\t\t\tvar type = types[i];\n\t\t\t\t\t\t\t\t\t\tif ( optsAttrs.hasOwnProperty( type )) {\n\t\t\t\t\t\t\t\t\t\t\tfor ( j in optsAttrs[type]) {\n\t\t\t\t\t\t\t\t\t\t\t\tif ( optsAttrs[type].hasOwnProperty( j )) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprefix = attributesList.indexOf( j ) > -1 && !j.startsWith( 'data-' ) ? '' : 'data-';\n\t\t\t\t\t\t\t\t\t\t\t\t\tmidPart = 'link' === type ? 'link-' : '';\n\t\t\t\t\t\t\t\t\t\t\t\t\taddOpt( prefix + midPart + j, optsAttrs[type][j], true );\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( data.link ) {\n\t\t\t\t\t\t\t\t\taddOpt( 'href', encodeURI( data.link ));\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ( 'glossary' === data.type ) {\n\t\t\t\t\t\t\t\t\tif ( !data.glossary_id || !data.text ) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'glossary-id', data.glossary_id );\n\t\t\t\t\t\t\t\t\t\tif ( data.disable_auto_translation ) {\n\t\t\t\t\t\t\t\t\t\t\taddOpt( 'disable_auto_translation', 'true' );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if ( 'tooltip' === data.type ) {\n\t\t\t\t\t\t\t\t\tif ( !data.tooltip_content || !data.text ) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'tooltip-content', escapeContent ? data.tooltip_content.replace( /</g, '&lt;' ).replace( />/g, '&gt;' ) : data.tooltip_content, true );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if ( 'mediatip' === data.type ) {\n\t\t\t\t\t\t\t\t\tif ( !data.mediatip_type || !data.mediatip_content || !data.text ) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\taddOpt( 'mediatip-type', data.mediatip_type );\n\t\t\t\t\t\t\t\t\t\taddOpt( 'mediatip-content', data.mediatip_content, true );\n\t\t\t\t\t\t\t\t\t\tif ( data.mediatip_caption ) {\n\t\t\t\t\t\t\t\t\t\t\taddOpt( 'mediatip-caption', data.mediatip_caption, true );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar finalContent = `[${  shortcode  } ${  optsStrs.join( ' ' )  }]${  data.text  }[/${  shortcode  }]${  tail }`;\n\t\t\t\t\t\t\t\titge.log( 'Final content:', finalContent );\n\t\t\t\t\t\t\t\treturn callback( finalContent, mode );\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}());\n\t\t\t\t\t},\n\t\t\t\t\terror: function error() {\n\t\t\t\t\t\tloader.remove();\n\t\t\t\t\t\titge.error( 'Error while getting TinyMCE form for Tip: ', arguments );\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\n\t\tfunction generateSelObject() {\n\t\t\tvar txtarea = $( '#content' ).get( 0 );\n\t\t\tvar sel = {\n\t\t\t\thtml: itge.replaceShortcodes( txtarea.value.substring( txtarea.selectionStart, txtarea.selectionEnd )),\n\t\t\t};\n\t\t\tsel.DOM = $.parseHTML( sel.html );\n\t\t\tsel.start = $( sel.DOM ).first().get( 0 );\n\t\t\tsel.end = $( sel.DOM ).last().get( 0 );\n\t\t\treturn sel;\n\t\t}\n\t\tfunction generateAttr( label, value, specEncode ) {\n\t\t\tvalue = String( value ).trim();\n\t\t\tif ( !label.match( /^[\\w_\\-]*$/ )) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn `${ stripQuotes( label.trim(), true )  }=\"${   !isNA( specEncode ) && specEncode ? value.replace( /\"/g, '&aquot;' ).replace( /\\n/g, '<br/>' ) : stripQuotes( value, true )  }\"`;\n\t\t}\n\t\tQTags.addButton( 'ithoughts_tt_gl-tip', 'ITG Tip', function onClickButton() {\n\t\t\titge.editorForms.tip( generateSelObject(), QTags.insertContent, true );\n\t\t});\n\t\tQTags.addButton( 'ithoughts_tt_gl-list', 'ITG List', function onClickButton() {\n\t\t\titge.editorForms.list( generateSelObject(), QTags.insertContent, true );\n\t\t});\n\t});\n})( iThoughts.v5 );\n\n},{}]},{},[1]);\n"]}